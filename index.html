<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8" />
        <title>SANKEY from Google Sheets</title>
        <link href="style/main.css" rel="stylesheet" type="text/css" />
        <style>
            .node rect{
                cursor:move;
                fill-opacity:.9;
                shape-rendering:crispEdges;
            }
            .node text{
                pointer-events:none;
                text-shadow:0 1px 0 #fff;
            }
            .link{
                fill:none;
                stroke:#000;
                stroke-opacity:.2;
            }
            .link:hover{
                stroke-opacity:.5;
            }</style>
        <script type="text/javascript" src="script/d3.v3.js"></script>
        <script src="script/sankey.js"></script>
        <script type="text/javascript" src="http://www.google.com/jsapi"></script>
        <script type="text/javascript">
            google.load('visualization', '1', {packages: ['corechart']});
        </script>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.6.2/jquery.min.js"></script>
        <script src="script/main.js"></script>
    </head>
    <body>
        <div id="nav">
            <div id="unfold">
                <a href="#" id="aUnfold" class="rightarrow"> </a>
            </div>
            <div id="leftcontent">
                <label for="gsKey">1. Google Spreadsheet key (e.g. <em>rvWgEEGK9xuUQBR1EFcxHWA</em>
                    ) or spreadsheet URL</label>
                <input type="text" id="gsKey" value="0AqGkLMU9sHmLdHNnV3BxaVk1MXF1VHJDbkFyc2cySUE"
                    size="60" onChange="preview()" />
                <input type="button" value="2. get sheet names" onclick="preview()" />
                <div id="loader">
                    <img src="style/ajax-loader.gif" alt="loader" />
                </div>
                <div id="sheetSelect">
                    <label for="vizUrl">3. Select sheet name:</label>
                    <select name="gsSheet" id="gsSheet" style="width:150px">
                        <option value="">&lt;- Get sheet names first</option>
                    </select>
                </div>
            </div>
        </div>
        <h1></h1>
        <p id="chart"></p>
        <footer>By <a href="//plus.google.com/114662816634467534305?prsrc=3" rel="author">Martin
                Hawksey</a>. Based on <a href="http://bost.ocks.org/mike/sankey/" target="_blank"
                >Mike Bostock's Sankey Example</a> and work of David Sherlock. <a
                href="http://mashe.hawksey.info/2013/03/sankey-your-google-spreadsheet-data-d3js/"
                target="_blank">Read more about this...</a></footer>
        <script type="text/javascript">
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-2382132-6']);
            _gaq.push(['_setDomainName', 'hawksey.info']);
            _gaq.push(['_trackPageview']);
            
            (function() {
            var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
            ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
            var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </body>
</html>
